<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>NFL Playoff Bracket Generator</title>

<style>
  /* ===== Global safety ===== */
  *, *::before, *::after { box-sizing: border-box; }

  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;              /* IMPORTANT: don't pad body on iPhone */
    background: #fff;
  }

  /* Wrap your body content in <div class="page"> ... </div> */
  .page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 32px 16px 16px;
  }

  h1 { margin: 30px 0 6px; text-align: center; }
  h2 { margin: 0 0 10px; text-align: center; }
  .note { color:#555; font-size:14px; margin-bottom:10px; text-align: center; }

  /* ---------- Form row ---------- */
  .form-row {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 10px;
    margin-bottom: 6px;
  }
  .form-row > div { text-align: left; }

  label { font-weight:700; display:block; margin-top:8px; }

  input {
    padding:10px;
    width: 240px;
    max-width: 90vw;
    font-size:16px;
    margin-top:4px;
    border: 1px solid #666;
    border-radius: 4px;
    display: block;
  }

  /* ---------- Bracket layout ---------- */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(360px, 520px));
    gap: 40px;                 /* space between AFC / NFC */
    justify-content: center;
    align-items: start;
    margin-top: 16px;
  }

  .conf {
    border:2px solid #000;
    border-radius:10px;
    padding:12px;
    max-width: 520px;
    width: 100%;
  }

  .conf h2,
  .conf h3 { text-align: center; }

  .round-title { margin: 12px 0 6px; }

  .match {
    border:2px solid #000;
    border-radius:10px;
    padding:8px;
    margin: 10px 0;
  }

  .team {
    padding:10px;
    border:2px solid #000;
    border-radius:8px;
    margin:4px 0;
    cursor:pointer;
    font-size:16px;
    user-select:none;
    text-align: left;

    display: flex;
    align-items: center;
    gap: 10px;
    min-width: 0;
  }

  .team img.logo {
    width: 26px;
    height: 26px;
    object-fit: contain;
    flex-shrink: 0;
  }

  /* Only show hover effects on real hover devices (desktop) */
  @media (hover: hover) and (pointer: fine) {
    .team:hover { background:#f6f6f6; }
  }

  .picked {
    background:#111;
    color:#fff;
    border-color:#111;
    font-weight:700;
  }

  .muted { opacity:.5; cursor:default; }

  /* Kill mobile tap highlight */
  .team, button { -webkit-tap-highlight-color: transparent; }

  /* Home team accent */
  .team.home {
    border-left: 6px solid #1789f0;
    padding-left: 10px;
  }

  .at {
    text-align: center;
    font-weight: 700;
    color: #000;
    margin: 6px 0;
    user-select: none;
    width: 100%;
  }

  /* Super Bowl wrap */
  .superbowl-wrap{
    display: flex;
    justify-content: center;
    margin-top: 24px;
  }

  /* ---------- Actions + output ---------- */
  .actions {
    margin-top:16px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content: center;
  }

  button {
    padding:12px 14px;
    border-radius:10px;
    border:1px solid #111;
    background:#111;
    color:#fff;
    font-size:16px;
    cursor:pointer;
  }

  button.secondary { background:#fff; color:#111; }

  textarea {
    width:100%;
    min-height:170px;
    margin-top:10px;
    padding:10px;
    font-family: ui-monospace, Menlo, Consolas, monospace;
    font-size:13px;
  }

  /* ---------- Tablet / small screens: collapse to one column ---------- */
  @media (max-width: 820px){
    .grid { grid-template-columns: 1fr; gap: 16px; }
  }

  /* ---------- Phones: spacing + gutters ---------- */
  @media (max-width: 520px) {
    .page{
      padding: 24px 14px;
      max-width: none;
    }

    /* Center the conference card and keep gutters */
    .conf{
      width: 100%;
      max-width: calc(100vw - 28px); /* 14px gutter each side */
      margin: 0 auto;
      padding: 16px;
    }

    /* Slightly smaller logos on phone */
    .team img.logo {
      width: 24px;
      height: 24px;
    }

    /* Form fields: add vertical separation */
    .form-row {
      gap: 16px;
      margin-bottom: 8px;
    }

    label { margin-top: 14px; }

    input {
      padding: 14px;
      font-size: 17px;   /* prevents iOS zoom */
      width: 92vw;
      max-width: 92vw;
    }

    /* Bracket spacing */
    .match { margin: 14px 0; }

    .team {
      padding: 14px;
      margin: 6px 0;
    }

    .at { margin: 10px 0; }

    /* Super Bowl separation */
    .superbowl-wrap { margin-top: 48px; }

    /* Buttons: easier thumbs */
    .actions {
      gap: 14px;
      margin-top: 36px;
    }

    button {
      padding: 14px 18px;
      font-size: 17px;
    }
  }
  /* ===== Pop: smooth interactions ===== */

/* Team button motion */
.team{
  transition:
    background-color 140ms ease,
    color 140ms ease,
    border-color 140ms ease,
    box-shadow 140ms ease,
    transform 140ms ease;
  will-change: transform;
}

/* Slight lift on hover (desktop only) */
@media (hover: hover) and (pointer: fine) {
  .team:not(.muted):hover{
    transform: translateY(-1px);
  }
}

/* "selected" bounce */
.team.picked{
  transform: translateY(-1px) scale(1.01);
  box-shadow: 0 6px 14px rgba(0,0,0,0.18);
}

/* Match cards fade in when re-rendered */
.match{
  animation: matchIn 180ms ease-out;
}

@keyframes matchIn{
  from { opacity: 0; transform: translateY(4px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* Respect reduced motion settings */
@media (prefers-reduced-motion: reduce) {
  .team{ transition: none; }
  .team.picked{ transform: none; box-shadow: none; }
  .match{ animation: none; }
}

</style>

</head>

<body>
  <h1>2026 NFL Playoffs Bracket Generator</h1>
  <h2>Please submit your picks by midnight on Friday, January 9th, 2026</h2>
  <div class="note">Tap a team to advance them. Seeding rules are enforced automatically (1 seed bye, 1 plays lowest remaining).</div>

<div class="form-row">
  <div>
    <label>Scoreboard name</label>
    <input id="scoreboardName" placeholder="Name shown on scoreboard" autocomplete="nickname">
  </div>

  <div>
    <label>Real name</label>
    <input id="realName" placeholder="Your real name" autocomplete="name">
  </div>

  <div>
    <label>Email</label>
    <input id="email" type="email" placeholder="you@example.com" autocomplete="email">
  </div>

  <div>
    <label>Phone</label>
    <input id="phone" type="tel" placeholder="(555) 555-5555" autocomplete="tel">
  </div>
</div>

  <div class="grid">
    <div class="conf" id="afc"></div>
    <div class="conf" id="nfc"></div>
  </div>

  <div class="superbowl-wrap">
  <div class="conf" id="superBowl"></div>
</div>


  <div class="actions">
    <button id="submitBtn">Submit Picks</button>
    <button class="secondary" id="csvBtn">Download CSV</button>
    <button class="secondary" id="resetBtn">Reset</button>
  </div>

  <textarea id="output" placeholder="Preview / backup text will show here"></textarea>

<script>
// ========================
// CONFIG
// ========================

// Replace team names once bracket is set

const initial = {
  afc: {
    name: "AFC",
    seeds: {
      1: { name: "Denver Broncos", code: "den" },
      2: { name: "New England Patriots", code: "ne" },
      3: { name: "Jacksonville Jaguars", code: "jax" },
      4: { name: "Pittsburgh Steelers", code: "pit" },
      5: { name: "Buffalo Bills", code: "buf" },
      6: { name: "Houston Texans", code: "hou" },
      7: { name: "Los Angeles Chargers", code: "lac" }
    }
  },

  nfc: {
    name: "NFC",
    seeds: {
      1: { name: "Seattle Seahawks", code: "sea" },
      2: { name: "Chicago Bears", code: "chi" },
      3: { name: "Philadelphia Eagles", code: "phi" },
      4: { name: "Carolina Panthers", code: "car" },
      5: { name: "San Francisco 49ers", code: "sf" },
      6: { name: "Los Angeles Rams", code: "lar" },
      7: { name: "Detroit Lions", code: "det" }
    }
  }
};


// Google Apps Script Web App URL
const BACKEND_URL = "https://script.google.com/macros/s/AKfycbw-4HuF7y0LiCyEHbRyTLnuKdmTaktl8YDM90vAp8vyx9eOZ9rtiy1w1W4aoq3j17hw/exec";

// ========================
// STATE + BRACKET LOGIC
// ========================
function makeConf(conf){
  const s = conf.seeds;
  const T = (seed) => ({ seed, ...s[seed] }); // <-- flatten {name, code} onto the team

  return {
    name: conf.name,
    wc: [
      { a: T(2), b: T(7), w: null },
      { a: T(3), b: T(6), w: null },
      { a: T(4), b: T(5), w: null },
    ],
    div: [
      { a: T(1), b: null, w: null },
      { a: null, b: null, w: null }
    ],
    conf: { a: null, b: null, w: null }
  };
}

let state = {
  afc: makeConf(initial.afc),
  nfc: makeConf(initial.nfc),
  sb: {a:null, b:null, w:null}
};

function sortBySeedAsc(arr){ return arr.slice().sort((x,y)=>x.seed-y.seed); }

function recomputeConference(conf){
  const wcWinners = conf.wc.map(m=>m.w).filter(Boolean);

  // If WC not complete, clear downstream
  if (wcWinners.length < 3){
    conf.div[0].b = null; conf.div[0].w = null;
    conf.div[1].a = null; conf.div[1].b = null; conf.div[1].w = null;
    conf.conf.a = null; conf.conf.b = null; conf.conf.w = null;
    return;
  }

  // Remaining teams: 1 seed + WC winners
  const remaining = [{seed:1, name:conf.div[0].a.name}, ...wcWinners];
  const sorted = sortBySeedAsc(remaining);

  // 1 plays lowest remaining (highest seed #)
  const lowest = sorted[sorted.length - 1];
  const others = sorted.slice(0, sorted.length - 1).filter(t => t.seed !== 1); // two teams

  conf.div[0].b = lowest;
  conf.div[1].a = others[0];
  conf.div[1].b = others[1];

  // Validate divisional winners
  conf.div.forEach(m=>{
    if (!m.a || !m.b) m.w = null;
    else if (m.w && ![m.a.seed, m.b.seed].includes(m.w.seed)) m.w = null;
  });

  // Conf champ from div winners
  const divWinners = conf.div.map(m=>m.w).filter(Boolean);
  if (divWinners.length < 2){
    conf.conf.a = null; conf.conf.b = null; conf.conf.w = null;
    return;
  }

  conf.conf.a = divWinners[0];
  conf.conf.b = divWinners[1];
  if (conf.conf.w && ![conf.conf.a.seed, conf.conf.b.seed].includes(conf.conf.w.seed)) conf.conf.w = null;
}

function recomputeAll(){
  recomputeConference(state.afc);
  recomputeConference(state.nfc);

  const a = state.afc.conf.w;
  const n = state.nfc.conf.w;

  if (!a || !n){
    state.sb.a = null; state.sb.b = null; state.sb.w = null;
    return;
  }

    state.sb.a = { seed: a.seed, name: a.name, code: a.code, conf: "AFC" };
    state.sb.b = { seed: n.seed, name: n.name, code: n.code, conf: "NFC" };

  if (state.sb.w && ![state.sb.a.name, state.sb.b.name].includes(state.sb.w.name)) state.sb.w = null;
}

// ========================
// RENDER HELPERS (NO inner HTML AFTER APPENDS)
// ========================
function clear(el){ while(el.firstChild) el.removeChild(el.firstChild); }

function el(tag, props={}, children=[]){
  const node = document.createElement(tag);
  Object.assign(node, props);
  for (const c of children) node.appendChild(typeof c === "string" ? document.createTextNode(c) : c);
  return node;
}

function teamNode(team, isPicked, onPick, extraClass = "") {
  const d = el("div", {
    className: "team" + (isPicked ? " picked" : "") + (extraClass ? " " + extraClass : "")
  });

  // Logo (from local /logos folder)
  if (team && team.code) {
    const img = el("img", {
      src: `logos/${team.code}.png`,
      alt: `${team.name} logo`,
      className: "logo"
    });
    img.onerror = () => { img.style.display = "none"; };
    d.appendChild(img);
  }

  const label = el("span", {}, [
    team ? `(${team.seed}) ${team.name}` : "—"
  ]);
  d.appendChild(label);

  if (!team || !onPick) {
    d.classList.add("muted");
  } else {
    d.addEventListener("click", onPick);
  }

  return d;
}

  
function sameTeam(a, b) {
  if (!a || !b) return false;

  // Name is the primary unique identifier
  if (a.name !== b.name) return false;

  // If conference exists (Super Bowl), ensure it matches
  if (a.conf && b.conf && a.conf !== b.conf) return false;

  return true;
}
  
function teamKey(t){
  if (!t) return "";
  return `${t.conf || ""}::${t.name || ""}`;
}

function matchNode(teamA, teamB, winner, pickA, pickB){
  const box = el("div", { className: "match" });

  // Home team = higher seed (lower seed number). Display home second.
  let away = teamA;
  let home = teamB;
  let pickAway = pickA;
  let pickHome = pickB;

  if (teamA && teamB && teamA.seed < teamB.seed) {
    // teamA is home, so swap
    away = teamB;
    home = teamA;
    pickAway = pickB;
    pickHome = pickA;
  }

box.appendChild(teamNode(
  away,
  !!(winner && away && teamKey(winner) === teamKey(away)),
  pickAway
));

box.appendChild(el("div", { className: "at" }, ["@"]));

box.appendChild(teamNode(
  home,
  !!(winner && home && teamKey(winner) === teamKey(home)),
  pickHome,
  "home"
));
  
  return box;
}

function renderConference(conf, mount){
  clear(mount);

  mount.appendChild(el("h2", {}, [conf.name]));

  // Wild Card
  mount.appendChild(el("h3", { className:"round-title" }, ["Wild Card"]));
  conf.wc.forEach((m)=>{
    mount.appendChild(matchNode(
      m.a, m.b, m.w,
      ()=>{ m.w = m.a; recomputeAll(); renderAll(); },
      ()=>{ m.w = m.b; recomputeAll(); renderAll(); }
    ));
  });

  // Divisional
  mount.appendChild(el("h3", { className:"round-title" }, ["Divisional"]));
  conf.div.forEach((m)=>{
    mount.appendChild(matchNode(
      m.a, m.b, m.w,
      m.a ? ()=>{ m.w = m.a; recomputeAll(); renderAll(); } : null,
      m.b ? ()=>{ m.w = m.b; recomputeAll(); renderAll(); } : null
    ));
  });

  // Conference Championship
  mount.appendChild(el("h3", { className:"round-title" }, ["Conference Championship"]));
  mount.appendChild(matchNode(
    conf.conf.a, conf.conf.b, conf.conf.w,
    conf.conf.a ? ()=>{ conf.conf.w = conf.conf.a; recomputeAll(); renderAll(); } : null,
    conf.conf.b ? ()=>{ conf.conf.w = conf.conf.b; recomputeAll(); renderAll(); } : null
  ));
}

function renderSuperBowl(mount){
  clear(mount);
  mount.appendChild(el("h2", {}, ["Super Bowl"]));
  mount.appendChild(matchNode(
    state.sb.a, state.sb.b, state.sb.w,
    state.sb.a ? () => { state.sb.w = state.sb.a; renderAll(); } : null,
    state.sb.b ? () => { state.sb.w = state.sb.b; renderAll(); } : null
  ));
}

function buildPreviewText(){
  const scoreboardName = (document.getElementById("scoreboardName").value || "").trim() || "[SCOREBOARD NAME MISSING]";
  const lines = [];
  lines.push(`Scoreboard name: ${scoreboardName}`);
  lines.push("");

  const addConf = (conf)=>{
    lines.push(`${conf.name}:`);
    conf.wc.forEach((m,i)=>lines.push(`  WC${i+1} (${m.a.seed}v${m.b.seed}): ${m.w ? m.w.name : "—"}`));
    conf.div.forEach((m,i)=>lines.push(`  DIV${i+1}: ${m.a ? m.a.name : "—"} vs ${m.b ? m.b.name : "—"} -> ${m.w ? m.w.name : "—"}`));
    lines.push(`  CONF: ${conf.conf.a ? conf.conf.a.name : "—"} vs ${conf.conf.b ? conf.conf.b.name : "—"} -> ${conf.conf.w ? conf.conf.w.name : "—"}`);
    lines.push("");
  };

  addConf(state.afc);
  addConf(state.nfc);

  lines.push(`Super Bowl: ${state.sb.a ? state.sb.a.name : "—"} vs ${state.sb.b ? state.sb.b.name : "—"} -> Champion: ${state.sb.w ? state.sb.w.name : "—"}`);
  document.getElementById("output").value = lines.join("\n");
}

function renderAll(){
  renderConference(state.afc, document.getElementById("afc"));
  renderConference(state.nfc, document.getElementById("nfc"));
  renderSuperBowl(document.getElementById("superBowl"));
  buildPreviewText();
}

renderAll();

// ========================
// SUBMIT + CSV
// ========================
function winnerObj(w) {
  return w ? { name: w.name, seed: w.seed } : null;
}

function buildPayload(){
  const scoreboardName = (document.getElementById("scoreboardName").value || "").trim();
  const realName = (document.getElementById("realName").value || "").trim();
  const email = (document.getElementById("email").value || "").trim();
  const phone = (document.getElementById("phone").value || "").trim();

  return {
    scoreboard_name: scoreboardName,
    real_name: realName,
    email: email,
    phone: phone,

    picks: {
      afc: {
        wc: state.afc.wc.map(m => m.w ? { name: m.w.name, seed: m.w.seed } : null),
        div: state.afc.div.map(m => m.w ? { name: m.w.name, seed: m.w.seed } : null),
        conf: state.afc.conf.w ? { name: state.afc.conf.w.name, seed: state.afc.conf.w.seed } : null
      },
      nfc: {
        wc: state.nfc.wc.map(m => m.w ? { name: m.w.name, seed: m.w.seed } : null),
        div: state.nfc.div.map(m => m.w ? { name: m.w.name, seed: m.w.seed } : null),
        conf: state.nfc.conf.w ? { name: state.nfc.conf.w.name, seed: state.nfc.conf.w.seed } : null
      }
    },

    sb_champ: state.sb.w ? state.sb.w.name : "",
    user_agent: navigator.userAgent
  };
}



document.getElementById("submitBtn").addEventListener("click", async ()=>{
  const scoreboardName = (document.getElementById("scoreboardName").value || "").trim();
  const realName = (document.getElementById("realName").value || "").trim();
  const email = (document.getElementById("email").value || "").trim();
  const phone = (document.getElementById("phone").value || "").trim();

  if (!scoreboardName) return alert("Enter your scoreboard name.");
  if (!realName) return alert("Enter your real name.");
  if (!email) return alert("Enter your email.");
  if (!phone) return alert("Enter your phone number.");
  if(!state.sb.w) return alert("Pick a Super Bowl champion before submitting.");

  // If no backend URL configured, just tell them to copy preview text
  if(!BACKEND_URL || BACKEND_URL.includes("PASTE_")){
    alert("Backend URL not set. Copy the preview text as your submission, or set BACKEND_URL in the HTML.");
    return;
  }

  const btn = document.getElementById("submitBtn");
  btn.disabled = true;
  btn.textContent = "Submitting...";

  try{
    await fetch(BACKEND_URL, {
      method:"POST",
      mode:"no-cors",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify(buildPayload())
    });
    alert("Submitted! You're good to go! Thanks for playing!");
    btn.textContent = "Submitted ✓";
  }catch(e){
    alert("Submit failed. Use Download CSV as backup.");
    btn.disabled = false;
    btn.textContent = "Submit Picks";
  }
});

document.getElementById("csvBtn").addEventListener("click", ()=>{
  const scoreboardName = (document.getElementById("scoreboardName").value || "").trim();
const realName = (document.getElementById("realName").value || "").trim();
const email = (document.getElementById("email").value || "").trim();
const phone = (document.getElementById("phone").value || "").trim();

if (!scoreboardName) return alert("Enter your scoreboard name.");
if (!realName) return alert("Enter your real name.");
if (!email) return alert("Enter your email.");
if (!phone) return alert("Enter your phone number.");
if (!state.sb.w) return alert("Pick a Super Bowl Champion before submitting.");

  const rows = [];
  const ts = new Date().toISOString();
  const push = (slot, pick)=>rows.push([ts, scoreboardName, slot, (pick||"")].join(","));

  state.afc.wc.forEach((m,i)=>push(`AFC_WC_${i+1}_(${m.a.seed}v${m.b.seed})`, m.w?.name));
  state.afc.div.forEach((m,i)=>push(`AFC_DIV_${i+1}`, m.w?.name));
  push("AFC_CONF", state.afc.conf.w?.name);

  state.nfc.wc.forEach((m,i)=>push(`NFC_WC_${i+1}_(${m.a.seed}v${m.b.seed})`, m.w?.name));
  state.nfc.div.forEach((m,i)=>push(`NFC_DIV_${i+1}`, m.w?.name));
  push("NFC_CONF", state.nfc.conf.w?.name);

  push("SB_CHAMP", state.sb.w?.name);

  const csv = "timestamp,name,slot,pick\n" + rows.join("\n");
  const blob = new Blob([csv], {type:"text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = `NFL_bracket_${scoreboardName.replace(/[^a-z0-9_-]+/gi,"_")}.csv`;
  // Optional: include contact info in the sheet backend; CSV is just a backup for scoring.

  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

document.getElementById("resetBtn").addEventListener("click", ()=>{
  state.afc = makeConf(initial.afc);
  state.nfc = makeConf(initial.nfc);
  state.sb = {a:null,b:null,w:null};
  renderAll();
});
</script>
</body>
</html>






